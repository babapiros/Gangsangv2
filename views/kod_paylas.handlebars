<style>
    .file-upload-container {
        border: 2px dashed #7289da;
        border-radius: 10px;
        padding: 2rem;
        text-align: center;
        margin: 1rem 0;
        transition: all 0.3s ease;
    }
    .file-upload-container:hover {
        background: #2b2d31;
        cursor: pointer;
    }
    #previewImage {
        max-width: 300px;
        border-radius: 8px;
        margin: 1rem auto;
        display: none;
    }
    .fa-file-upload {
        font-size: 3rem;
        color: #7289da;
    }
</style>

<title>LevyScript | Kod Paylaş</title>
<main>
  <div class="container mt-5">
    <h1 class="text-center text-light mb-4">Kod Paylaş</h1>
    <div class="alert alert-dark">
      <p class="text-center mb-0">Trol amaçlı paylaşımlar sunucuda <strong>kara liste</strong> ile sonuçlanacaktır!</p>
    </div>
    
    <form action="/paylasim" method="POST" enctype="multipart/form-data" class="bg-dark p-4 rounded">
      <!-- Oyun Bilgileri -->
      <div class="row mb-4">
        <div class="col-md-4">
          <input type="text" class="form-control mb-3" name="game_name" placeholder="Oyun Adı" required>
        </div>
        <div class="col-md-4">
          <input type="text" class="form-control mb-3" name="game_id" placeholder="Oyun ID" required>
        </div>
        <div class="col-md-4">
          <input type="url" class="form-control mb-3" name="game_url" placeholder="Oyun URL" required>
        </div>
      </div>

      <!-- Kod Bilgileri -->
      <div class="input-group mb-3">
        <input type="text" class="form-control" name="kod_adi" placeholder="Kod Adı" required>
        <select class="form-select bg-dark text-light" name="kod_rank" required>
          <option value="script">Roblox Script</option>
          <option value="topluluk">Topluluk</option>
        </select>
      </div>

      <input type="text" class="form-control mb-3" name="desc" placeholder="Kod Açıklaması" required>
      <input type="text" class="form-control mb-3" name="modules" placeholder="Kullanılan Modüller (virgülle ayırın)" required>
      <input type="text" class="form-control mb-3" name="author" placeholder="Kod Sahipleri (virgülle ayırın)" required>

      <!-- Dosya Yükleme Alanı -->
      <div class="file-upload-container" onclick="document.getElementById('fileInput').click()">
        <i class="fas fa-file-upload"></i>
        <p class="text-light mt-2 mb-0">Resim/Dosya Yükle (Sürükle-Bırak)</p>
        <input type="file" id="fileInput" name="file" hidden accept="image/*" onchange="previewFile(event)">
      </div>
      <img id="previewImage" src="#" alt="Önizleme" class="img-fluid">

      <!-- Kod Editör Alanları -->
      <div class="mb-4">
        <label class="text-light mb-2">Ana Kod:</label>
        <textarea class="form-control bg-secondary text-light" name="main_code" rows="10" placeholder="Kodunuzu buraya yazın..." spellcheck="false"></textarea>
      </div>

      <div class="mb-4">
        <label class="text-light mb-2">Ek Kodlar:</label>
        <textarea class="form-control bg-secondary text-light" name="komutlar_code" rows="10" placeholder="Ek kodlarınızı buraya yazın..." spellcheck="false"></textarea>
      </div>

      <input type="hidden" name="k_adi" value="{{user.username}}">
      <button type="submit" class="btn btn-primary btn-lg w-100">
        <i class="fas fa-paper-plane me-2"></i>Paylaş
      </button>
    </form>
  </div>
</main>

<script>
function previewFile(event) {
    const file = event.target.files[0];
    const preview = document.getElementById('previewImage');
    const reader = new FileReader();

    reader.onloadend = function() {
        preview.src = reader.result;
        preview.style.display = 'block';
    }

    if (file) {
        reader.readAsDataURL(file);
    } else {
        preview.src = "#";
        preview.style.display = 'none';
    }
}

// Drag & Drop desteği
const dropZone = document.querySelector('.file-upload-container');

dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.style.background = '#36393f';
});

dropZone.addEventListener('dragleave', () => {
    dropZone.style.background = 'transparent';
});

dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.style.background = 'transparent';
    const file = e.dataTransfer.files[0];
    document.getElementById('fileInput').files = e.dataTransfer.files;
    previewFile({ target: document.getElementById('fileInput') });
});
</script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
